#map = "a;http://www.w3.org/2005/Atom--address;http://schemas.talis.com/2005/address/schema#--admin;http://webns.net/mvcb/--atom;http://atomowl.org/ontologies/atomrdf#--aws;http://soap.amazon.com/--b3s;http://b3s.openlinksw.com/--batch;http://schemas.google.com/gdata/batch--bibo;http://purl.org/ontology/bibo/--bif;bif:--bugzilla;http://www.openlinksw.com/schemas/bugzilla#--c;http://www.w3.org/2002/12/cal/icaltzd#--campsite;http://www.openlinksw.com/campsites/schema#--cb;http://www.crunchbase.com/--cc;http://web.resource.org/cc/--content;http://purl.org/rss/1.0/modules/content/--cv;http://purl.org/captsolo/resume-rdf/0.2/cv#--cvbase;http://purl.org/captsolo/resume-rdf/0.2/base#--dawgt;http://www.w3.org/2001/sw/DataAccess/tests/test-dawg#--dbc;http://dbpedia.org/resource/Category:--dbo;http://dbpedia.org/ontology/--dbp;http://dbpedia.org/property/--dbr;http://dbpedia.org/resource/--dc;http://purl.org/dc/elements/1.1/--dct;http://purl.org/dc/terms/--digg;http://digg.com/docs/diggrss/--dul;http://www.ontologydesignpatterns.org/ont/dul/DUL.owl--ebay;urn:ebay:apis:eBLBaseComponents--enc;http://purl.oclc.org/net/rss_2.0/enc#--exif;http://www.w3.org/2003/12/exif/ns/--fb;http://api.facebook.com/1.0/--ff;http://api.friendfeed.com/2008/03--fn;http://www.w3.org/2005/xpath-functions/#--foaf;http://xmlns.com/foaf/0.1/--freebase;http://rdf.freebase.com/ns/--g;http://base.google.com/ns/1.0--gb;http://www.openlinksw.com/schemas/google-base#--gd;http://schemas.google.com/g/2005--geo;http://www.w3.org/2003/01/geo/wgs84_pos#--geonames;http://www.geonames.org/ontology#--georss;http://www.georss.org/georss/--gml;http://www.opengis.net/gml--go;http://purl.org/obo/owl/GO#--hlisting;http://www.openlinksw.com/schemas/hlisting/--hoovers;http://wwww.hoovers.com/--hrev;http://www.purl.org/stuff/hrev#--ical;http://www.w3.org/2002/12/cal/ical#--ir;http://web-semantics.org/ns/image-regions--itunes;http://www.itunes.com/DTDs/Podcast-1.0.dtd--ldp;http://www.w3.org/ns/ldp#--lgv;http://linkedgeodata.org/vocabulary#--link;http://www.xbrl.org/2003/linkbase--lod;http://lod.openlinksw.com/--math;http://www.w3.org/2000/10/swap/math#--media;http://search.yahoo.com/mrss/--mesh;http://purl.org/commons/record/mesh/--meta;urn:oasis:names:tc:opendocument:xmlns:meta:1.0--mf;http://www.w3.org/2001/sw/DataAccess/tests/test-manifest#--mmd;http://musicbrainz.org/ns/mmd-1.0#--mo;http://purl.org/ontology/mo/--mql;http://www.freebase.com/--nci;http://ncicb.nci.nih.gov/xml/owl/EVS/Thesaurus.owl#--nfo;http://www.semanticdesktop.org/ontologies/nfo/#--ng;http://www.openlinksw.com/schemas/ning#--nyt;http://www.nytimes.com/--oai;http://www.openarchives.org/OAI/2.0/--oai_dc;http://www.openarchives.org/OAI/2.0/oai_dc/--obo;http://www.geneontology.org/formats/oboInOwl#--office;urn:oasis:names:tc:opendocument:xmlns:office:1.0--ogc;http://www.opengis.net/--ogcgml;http://www.opengis.net/ont/gml#--ogcgs;http://www.opengis.net/ont/geosparql#--ogcgsf;http://www.opengis.net/def/function/geosparql/--ogcgsr;http://www.opengis.net/def/rule/geosparql/--ogcsf;http://www.opengis.net/ont/sf#--oo;urn:oasis:names:tc:opendocument:xmlns:meta:1.0:--openSearch;http://a9.com/-/spec/opensearchrss/1.0/--opencyc;http://sw.opencyc.org/2008/06/10/concept/--opl;http://www.openlinksw.com/schema/attribution#--opl-gs;http://www.openlinksw.com/schemas/getsatisfaction/--opl-meetup;http://www.openlinksw.com/schemas/meetup/--opl-xbrl;http://www.openlinksw.com/schemas/xbrl/--oplweb;http://www.openlinksw.com/schemas/oplweb#--ore;http://www.openarchives.org/ore/terms/--owl;http://www.w3.org/2002/07/owl#--product;http://www.buy.com/rss/module/productV2/--protseq;http://purl.org/science/protein/bysequence/--r;http://backend.userland.com/rss2--radio;http://www.radiopop.co.uk/--rdf;http://www.w3.org/1999/02/22-rdf-syntax-ns#--rdfa;http://www.w3.org/ns/rdfa#--rdfdf;http://www.openlinksw.com/virtrdf-data-formats#--rdfs;http://www.w3.org/2000/01/rdf-schema#--rev;http://purl.org/stuff/rev#--review;http://www.purl.org/stuff/rev#--rss;http://purl.org/rss/1.0/--sc;http://purl.org/science/owl/sciencecommons/--scovo;http://purl.org/NET/scovo#--sd;http://www.w3.org/ns/sparql-service-description#--sf;urn:sobject.enterprise.soap.sforce.com--sioc;http://rdfs.org/sioc/ns#--sioct;http://rdfs.org/sioc/types#--skiresort;http://www.openlinksw.com/ski_resorts/schema#--skos;http://www.w3.org/2004/02/skos/core#--slash;http://purl.org/rss/1.0/modules/slash/--sql;sql:--stock;http://xbrlontology.com/ontology/finance/stock_market#--twfy;http://www.openlinksw.com/schemas/twfy#--umbel;http://umbel.org/umbel#--umbel-ac;http://umbel.org/umbel/ac/--umbel-rc;http://umbel.org/umbel/rc/--umbel-sc;http://umbel.org/umbel/sc/--uniprot;http://purl.uniprot.org/--units;http://dbpedia.org/units/--usc;http://www.rdfabout.com/rdf/schema/uscensus/details/100pct/--v;http://www.openlinksw.com/xsltext/--vcard;http://www.w3.org/2001/vcard-rdf/3.0#--vcard2006;http://www.w3.org/2006/vcard/ns#--vi;http://www.openlinksw.com/virtuoso/xslt/--virt;http://www.openlinksw.com/virtuoso/xslt--virtcxml;http://www.openlinksw.com/schemas/virtcxml#--virtpivot;http://www.openlinksw.com/schemas/virtpivot#--virtrdf;http://www.openlinksw.com/schemas/virtrdf#--void;http://rdfs.org/ns/void#--wb;http://www.worldbank.org/--wdrs;http://www.w3.org/2007/05/powder-s#--wf;http://www.w3.org/2005/01/wf/flow#--wfw;http://wellformedweb.org/CommentAPI/--wikicompany;http://dbpedia.openlinksw.com/wikicompany/--wikidata;http://www.wikidata.org/entity/--xf;http://www.w3.org/2004/07/xpath-functions--xfn;http://gmpg.org/xfn/11#--xhtml;http://www.w3.org/1999/xhtml--xhv;http://www.w3.org/1999/xhtml/vocab#--xi;http://www.xbrl.org/2003/instance--xml;http://www.w3.org/XML/1998/namespace--xn;http://www.ning.com/atom/1.0--xsd;http://www.w3.org/2001/XMLSchema#--xsl10;http://www.w3.org/XSL/Transform/1.0--xsl1999;http://www.w3.org/1999/XSL/Transform--xslwd;http://www.w3.org/TR/WD-xsl--y;urn:yahoo:maps--yago;http://dbpedia.org/class/yago/--yago-res;http://mpii.de/yago/resource/--yt;http://gdata.youtube.com/schemas/2007--zem;http://s.zemanta.com/ns#"
maps = {'http://www.w3.org/2007/05/powder-s#': 'wdrs', 'urn:oasis:names:tc:opendocument:xmlns:meta:1.0:': 'oo', 'http://www.w3.org/2002/12/cal/ical#': 'ical', 'http://a9.com/-/spec/opensearchrss/1.0/': 'openSearch', 'http://www.opengis.net/ont/gml#': 'ogcgml', 'http://www.w3.org/ns/sparql-service-description#': 'sd', 'http://api.facebook.com/1.0/': 'fb', 'http://www.openlinksw.com/schemas/getsatisfaction/': 'opl-gs', 'http://backend.userland.com/rss2': 'r', 'http://www.w3.org/2003/01/geo/wgs84_pos#': 'geo', 'http://www.w3.org/2005/xpath-functions/#': 'fn', 'bif:': 'bif', 'http://www.w3.org/2005/01/wf/flow#': 'wf', 'http://www.geonames.org/ontology#': 'geonames', 'http://www.w3.org/ns/ldp#': 'ldp', 'http://purl.org/science/owl/sciencecommons/': 'sc', 'http://schemas.google.com/gdata/batch': 'batch', 'http://purl.org/commons/record/mesh/': 'mesh', 'http://www.openlinksw.com/schemas/oplweb#': 'oplweb', 'http://s.zemanta.com/ns#': 'zem', 'http://www.freebase.com/': 'mql', 'http://purl.org/captsolo/resume-rdf/0.2/base#': 'cvbase', 'http://digg.com/docs/diggrss/': 'digg', 'urn:oasis:names:tc:opendocument:xmlns:meta:1.0': 'meta', 'sql:': 'sql', 'urn:ebay:apis:eBLBaseComponents': 'ebay', 'http://www.crunchbase.com/': 'cb', 'http://www.w3.org/1999/XSL/Transform': 'xsl1999', 'http://www.openlinksw.com/schemas/hlisting/': 'hlisting', 'http://www.openarchives.org/ore/terms/': 'ore', 'http://www.w3.org/2001/sw/DataAccess/tests/test-dawg#': 'dawgt', 'http://rdf.freebase.com/ns/': 'freebase', 'http://www.rdfabout.com/rdf/schema/uscensus/details/100pct/': 'usc', 'http://www.xbrl.org/2003/linkbase': 'link', 'http://dbpedia.org/ontology/': 'dbo', 'http://www.openlinksw.com/campsites/schema#': 'campsite', 'http://www.w3.org/1999/02/22-rdf-syntax-ns#': 'rdf', 'http://www.buy.com/rss/module/productV2/': 'product', 'urn:sobject.enterprise.soap.sforce.com': 'sf', 'http://www.openarchives.org/OAI/2.0/': 'oai', 'http://dbpedia.org/resource/': 'dbr', 'http://www.openlinksw.com/schemas/meetup/': 'opl-meetup', 'http://purl.oclc.org/net/rss_2.0/enc#': 'enc', 'http://www.openlinksw.com/schemas/bugzilla#': 'bugzilla', 'http://www.radiopop.co.uk/': 'radio', 'http://www.nytimes.com/': 'nyt', 'http://web-semantics.org/ns/image-regions': 'ir', 'http://www.openlinksw.com/virtrdf-data-formats#': 'rdfdf', 'http://www.w3.org/2001/XMLSchema#': 'xsd', 'http://www.itunes.com/DTDs/Podcast-1.0.dtd': 'itunes', 'http://www.georss.org/georss/': 'georss', 'http://purl.org/NET/scovo#': 'scovo', 'http://www.opengis.net/gml': 'gml', 'http://atomowl.org/ontologies/atomrdf#': 'atom', 'http://www.w3.org/2004/07/xpath-functions': 'xf', 'http://purl.org/ontology/mo/': 'mo', 'http://www.worldbank.org/': 'wb', 'http://gdata.youtube.com/schemas/2007': 'yt', 'http://www.w3.org/2005/Atom': 'a', 'http://purl.org/obo/owl/GO#': 'go', 'http://schemas.talis.com/2005/address/schema#': 'address', 'http://www.semanticdesktop.org/ontologies/nfo/#': 'nfo', 'http://musicbrainz.org/ns/mmd-1.0#': 'mmd', 'http://www.ontologydesignpatterns.org/ont/dul/DUL.owl': 'dul', 'http://webns.net/mvcb/': 'admin', 'http://umbel.org/umbel/ac/': 'umbel-ac', 'http://schemas.google.com/g/2005': 'gd', 'http://gmpg.org/xfn/11#': 'xfn', 'http://www.w3.org/XML/1998/namespace': 'xml', 'http://www.wikidata.org/entity/': 'wikidata', 'http://www.w3.org/2006/vcard/ns#': 'vcard2006', 'http://www.geneontology.org/formats/oboInOwl#': 'obo', 'urn:oasis:names:tc:opendocument:xmlns:office:1.0': 'office', 'http://purl.org/dc/elements/1.1/': 'dc', 'http://www.openlinksw.com/schema/attribution#': 'opl', 'http://ncicb.nci.nih.gov/xml/owl/EVS/Thesaurus.owl#': 'nci', 'http://www.w3.org/2004/02/skos/core#': 'skos', 'http://rdfs.org/ns/void#': 'void', 'http://www.xbrl.org/2003/instance': 'xi', 'http://www.w3.org/2001/vcard-rdf/3.0#': 'vcard', 'http://rdfs.org/sioc/ns#': 'sioc', 'http://www.openlinksw.com/virtuoso/xslt/': 'vi', 'http://www.w3.org/1999/xhtml': 'xhtml', 'http://purl.org/stuff/rev#': 'rev', 'http://b3s.openlinksw.com/': 'b3s', 'http://www.w3.org/TR/WD-xsl': 'xslwd', 'http://www.opengis.net/def/function/geosparql/': 'ogcgsf', 'http://purl.org/science/protein/bysequence/': 'protseq', 'http://www.openarchives.org/OAI/2.0/oai_dc/': 'oai_dc', 'http://www.opengis.net/ont/sf#': 'ogcsf', 'http://purl.org/rss/1.0/': 'rss', 'http://sw.opencyc.org/2008/06/10/concept/': 'opencyc', 'http://umbel.org/umbel/sc/': 'umbel-sc', 'http://dbpedia.org/class/yago/': 'yago', 'http://wwww.hoovers.com/': 'hoovers', 'http://soap.amazon.com/': 'aws', 'http://www.openlinksw.com/ski_resorts/schema#': 'skiresort', 'http://web.resource.org/cc/': 'cc', 'http://www.opengis.net/def/rule/geosparql/': 'ogcgsr', 'http://dbpedia.openlinksw.com/wikicompany/': 'wikicompany', 'http://www.w3.org/2001/sw/DataAccess/tests/test-manifest#': 'mf', 'http://www.openlinksw.com/schemas/twfy#': 'twfy', 'http://rdfs.org/sioc/types#': 'sioct', 'http://www.openlinksw.com/schemas/virtrdf#': 'virtrdf', 'http://www.purl.org/stuff/rev#': 'review', 'http://lod.openlinksw.com/': 'lod', 'http://www.purl.org/stuff/hrev#': 'hrev', 'http://www.w3.org/2002/12/cal/icaltzd#': 'c', 'http://base.google.com/ns/1.0': 'g', 'http://purl.org/dc/terms/': 'dct', 'http://xmlns.com/foaf/0.1/': 'foaf', 'http://www.w3.org/2000/01/rdf-schema#': 'rdfs', 'http://www.openlinksw.com/virtuoso/xslt': 'virt', 'http://www.openlinksw.com/schemas/virtcxml#': 'virtcxml', 'http://purl.org/rss/1.0/modules/content/': 'content', 'http://www.w3.org/2002/07/owl#': 'owl', 'http://www.w3.org/2003/12/exif/ns/': 'exif', 'http://www.openlinksw.com/schemas/ning#': 'ng', 'http://www.openlinksw.com/xsltext/': 'v', 'http://www.w3.org/1999/xhtml/vocab#': 'xhv', 'http://wellformedweb.org/CommentAPI/': 'wfw', 'http://www.openlinksw.com/schemas/virtpivot#': 'virtpivot', 'http://www.w3.org/XSL/Transform/1.0': 'xsl10', 'http://linkedgeodata.org/vocabulary#': 'lgv', 'http://api.friendfeed.com/2008/03': 'ff', 'http://xbrlontology.com/ontology/finance/stock_market#': 'stock', 'http://www.opengis.net/ont/geosparql#': 'ogcgs', 'http://www.ning.com/atom/1.0': 'xn', 'http://www.openlinksw.com/schemas/google-base#': 'gb', 'http://purl.org/rss/1.0/modules/slash/': 'slash', 'http://purl.org/ontology/bibo/': 'bibo', 'http://dbpedia.org/property/': 'dbp', 'http://www.opengis.net/': 'ogc', 'http://www.w3.org/ns/rdfa#': 'rdfa', 'http://purl.uniprot.org/': 'uniprot', 'http://mpii.de/yago/resource/': 'yago-res', 'http://dbpedia.org/resource/Category:': 'dbc', 'http://umbel.org/umbel/rc/': 'umbel-rc', 'http://dbpedia.org/units/': 'units', 'http://www.openlinksw.com/schemas/xbrl/': 'opl-xbrl', 'http://www.w3.org/2000/10/swap/math#': 'math', 'urn:yahoo:maps': 'y', 'http://umbel.org/umbel#': 'umbel', 'http://search.yahoo.com/mrss/': 'media', 'http://purl.org/captsolo/resume-rdf/0.2/cv#': 'cv'}

ignored = ["Thing", "Yago", "Abstraction", "Attribute", "Symbol", "Substance", "Artifact", "Whole", "Object"]

dqueryPattern = """
            PREFIX yago: <http://dbpedia.org/class/yago/>
            PREFIX db: <http://dbpedia.org/resource/>
            PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
            PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
            select ?type (GROUP_CONCAT(?class; separator=">") AS ?group)
            where {
            <URI> rdf:type ?type.
            ?type rdfs:subClassOf+ ?class.
            }
            GROUP BY ?type
        """

def getPrefix(uri):
    global maps
    """if not maps:
        maps = {st.split(";")[1] : st.split(";")[0] for st in map.split("--")}
    print(maps)
    """
    return  maps[uri] if uri in maps else uri


def format(uris):
    return [getPrefix(uri) for uri in uris]


def remove_duplicates(x):
    a = []
    for i in x:
        if i in ignored or 'Yago' in i:
            break
        if i not in a:
            a.append(i)
    return a

def filter(_dict):
    key, val = None, []
    for k in _dict.keys():
        if len(_dict[k]) > len(val) :
            val = _dict[k]
            key = k
    kk = [key]
    kk.extend(val)
    return kk



def removeNumeric(text):
    return ''.join(i for i in text if not i.isdigit())
